000
Ça c'est une pub pour un jeu mobile qui
001
s'appelle la.
006
Du moins, c'est ce que tu crois jusqu'à
007
ce que tu l'installe et que tu te rendes
008
compte que tu t'es bien fait avoir. Non
010
mais sérieusement, c'est quoi ça  Moi
013
là-bas, j'étais chargé le jeu pour
014
pouvoir bouger un bonhomme sur un pont
015
et tirer sur des trucs avec des
016
multiplicateurs de dégâts. Bon, comme on
018
est plus de 50 millions à être très déçu
020
et que le jeu fait beaucoup parler de
021
lui ces derniers temps, je vais le créer
022
moi-même. Pour des raisons d'habitude,
024
je vais utiliser ce moteur de jeu
025
gratuit qui s'appelle Unity, mais les
027
autres moteurs feraient l'affaire aussi.
029
OK, le jeu s'appellera la vrai jeu mais
031
en anglais.
033
La première chose qu'on voit directement
034
dans la pub, c'est ce pont. Donc j'ai
036
fait une version simplifiée en partant
037
de ce cube puisque pour l'instant c'est
039
juste un prototype. On s'occupera des
041
graphismes après. Le personnage sera une
043
simple capsule. Le problème c'est qu'on
045
ne peut pas vraiment savoir dans quelle
046
direction il regarde.
049
J'ai ensuite écrit ce code très simple
050
pour le mouvement du personnage et OK,
052
tout fonctionne. Certaines versions de
054
la pub, le personnage ne peut se
055
déplacer qu'à l'horizontale et dans
057
d'autres dans cette petite zone
058
rectangulaire. La seconde option rend le
100
jeu plus dynamique.
102
Si on augmente le nombre de joueurs, ça
103
marche toujours mais ils sont un peu
104
trop resserrés à mon goût. Si j'amplifie
107
la force qui les sépare, qui est gérée
108
par cette partie là du code, c'est
110
parfait.
112
Maintenant, ils doivent pouvoir tirer.
113
Dans la pub, il tire environ tr balles
115
chaque seconde, mais cette cadence peut
116
augmenter en récupérant des nouvelles
117
armes. En fait, ici, une balle sera
119
juste une capsule qui émet de la lumière
121
et qui laisse derrière elle une petite
123
traînée. J'ai codé tout ça en faisant
125
une petite optimisation d'accès à la
126
mémoire. Plutôt que d'avoir un script
128
pour chaque balle, j'ai un seul script
129
qui gère toutes les balles. Ça peut
131
paraître insignifiant et pourtant si on
133
tire un très grand nombre de balles, la
135
différence en performance est juste
136
énorme.
139
Maintenant, je vais créer la mécanique
141
la plus importante de la pub. C'est
142
cette chose qu'on va appeler booster. En
144
fait, c'est une sorte d'hologramme avec
146
un gradient de couleur, du texte et le
148
tout supporté par une structure en
149
métal.
151
Voilà comment il fonctionne. Quand un
152
des personnages touche le booster, ce
154
dernier disparaît et te donne le bonus
155
que tu as touché. Et si tu lui tires
157
dessus, le bonus augmente s'il est
159
positif et il diminue s'il est négatif.
201
Tu as peut-être remarqué que les
202
boosters sont pas toujours les mêmes.
204
Dans la pub de gauche, il augmente les
205
balles et dans celle de droite, les
206
personnages. Et on dirait qu'il n'existe
208
jamais les deux types dans le même
209
niveau. Il ne reste déjà plus que deux
211
choses à faire  les ennemis et les
213
bonus. Un ennemi pour l'instant sera un
215
personnage bleu mais rouge et les bonus
217
sont un empilement de pneus.
220
Maintenant que le prototype est fini, le
222
jeu a besoin de vrais graphismes, des
224
modèles 3D similaires à ceux visibles
225
dans la pub.
227
Le jeu n'existe pas, donc je ne risque
229
pas de retrouver les modèles exacts. À
230
la place, j'ai utilisé cet outil de
232
modélisation gratuite nommé Blender et
234
j'ai recréé du mieux que je peux les
235
personnages visibles dans la pub. Je
237
pense que c'est pas si mal au vu du peu
239
de détails qu'on peut apercevoir. De la
241
même manière, j'ai créé les autres
242
modèles, le pneu, les armes et les
244
détails du pont. et avec les textures,
245
ça donne ça.
249
Pour les animations, je vais utiliser
250
cet outil gratuit que tous les Game de
252
connaissent, Mixamo. Il permet en
254
quelques secondes d'animer n'importe
255
quel modèle 3D et il possède cette
257
grosse banque d'animation où j'ai trouvé
259
exactement ce que je cherchais. Pour les
301
ennemis, j'ai pris l'initiative de ne
302
pas copier les animations de la pub et
304
de faire quelque chose qui me semble
305
tout aussi bien. Ça commence à être pas
307
si mal, mais c'est pas encore ça. En
309
fait, il manque tous ces petits détails
310
qui rendent le jeu dynamique et si
312
unique. Et bien, tous ces détails
313
constituent ce qui s'appelle le game
315
field. Regarde, ça c'est un cube qui
317
saute. Jusqu'ici, rien d'inattendu.
319
Maintenant, si on reprend ce même cube
320
et qu'on y ajoute une transformation,
322
une vibration et du son, le tout au bon
324
moment, voilà ce que ça donne.
327
On peut appliquer cette idée partout,
329
même sur un simple bouton comme
330
celui-ci. Là, c'est sans gam et ici
333
avec.
336
Maintenant, revenons à la soir. Dans la
338
pub, on peut apercevoir quatre effets
340
majeurs  agrandissement, destruction,
342
VFX et ragdol. Certains effets sont plus
344
difficiles à faire que d'autres et si on
346
devait les arranger par ordre croissant
348
de difficulté, selon moi, ce serait ça.
350
Si on applique tous ces effets au jeu,
352
ça donne ça.
354
Et je pense qu'on commence à être pas si
356
mal. On pourrait presque penser que le
357
jeu est fini. Sauf que non, c'est ici
400
que les choses se compliquent. Depuis le
401
début, je mets de côté l'océan qu'il y a
403
en dessous du pont. Je pourrais laisser
404
un fond de couleur comme dans certaines
405
versions de la pub et appeler ça choix
407
artistique. Sauf que c'est pas vraiment
408
le but de cette vidéo. Donc comment
410
exactement est-ce qu'on simule de l'eau
412
 Il existe plein de techniques
413
compliquées qui utilisent les
414
transformations rapides de Fourier ou
416
encore les flux de l'érien, mais ici ce
418
ne sera pas nécessaire. Il suffit de
419
revenir aux bases. Ça, c'est la fonction
422
sinus. Elle ressemble un peu à des
423
vagues. On peut modifier son amplitude
425
en la multipliant par une valeur et on
427
peut modifier sa fréquence en
428
multipliant x par une valeur. Si on
430
ajoute un temp t à x et qu'on fait
432
variété, on obtient cette animation. Et
434
si on combine tout, celle-ci. Pour
436
passer en trois dimensions, il suffit
437
d'ajouter une deuxième variable qu'on va
438
appeler y. Et en fait, c'est déjà
441
quasiment fini. Il ne reste qu'à changer
443
la direction des vagues, autrement dit à
445
trouver les coefficients devant X et Y.
447
Pour ça, on projette le vecteur X Y vers
448
la direction qu'on veut, mais
450
normaliser.
451
Et si on tout ça, voilà le résultat.
454
Comme tu peux le voir, ça ne ressemble
455
pas du tout à de l'eau. Donc, on a fait
457
tout ça pour rien, pas vraiment.
458
Jusqu'ici, j'ai utilisé une seule
500
fonction sinus. Mais on peut adapter le
502
code pour en sommer plusieurs. Avec
503
deux, j'obtiens ça. Puis avec trois et
506
avec quatre. Et on peut continuer comme
508
ça longtemps.
511
En choisissant les bons paramètres et
512
les bonnes couleurs, j'obtiens ça.
517
Maintenant que le jeu est visuellement
518
fini, il est temps de le tester sur un
520
vrai appareil. J'ai pris ce vieux
521
téléphone d'attente de 2015 qui est à
523
peu près comparable à cet iPhone et j'ai
525
testé le jeu. Honnêtement, c'est pas une
527
catastrophe. Le jeu tourne à environ 30
529
FPS avec des chutes à 18.
531
Le vrai problème arrive quand on affiche
532
un peu trop de personnages. Avec ces
535
quelques 5 FPS, le jeu devient tout
536
simplement injouable. J'ai donc
538
investiguer les raisons de cette baisse
540
considérable de performance et j'ai
541
trouvé que le problème venait de la
542
partie graphique, plus précisément des
545
animations. Prenons cette animation par
547
exemple. Elle est constituée de
548
plusieurs keyframes qui sont rien de
550
plus que des valeurs pour des propriétés
551
qu'on a-même créé. Ici, j'ai 5 key
553
frames et le problème c'est que dans
555
Unity, il se passe ça. Il comble le vide
558
en générant des keyframes
559
intermédiaires. Ça s'appelle de
601
l'interpolation.
603
Pour ça, le moteur doit calculer une
604
matrice d'ossature dans le CPU puis
606
l'envoyer au GPU. C'est cette dernière
608
étape qui est très coûteuse. À la place,
610
j'ai créé mon propre moteur d'animation
611
qui précalcule un petit nombre
613
d'interpolations puis qui instancie les
614
modèles plutôt que de les animer. J'ai
616
relancé le jeu sur le même téléphone et
618
on passe de 5 FPS en moyenne à quasiment
620
25. En fait, le gain ici est bien plus
622
conséquent, mais il y a beaucoup
623
d'autres points qui devraient être
624
encore optimisés. À ce stade, la
626
question n'est plus vraiment pourquoi le
627
jeu n'est pas mieux optimisé, mais
628
plutôt combien de gens ont encore un
630
téléphone aussi vieux  Ça
632
représenterait moins de 5 % des
633
appareils.
636
Bon, nous y voilà. Enfin, le jeu est
638
jouable et le résultat est pas trop
639
mauvais. C'est évidemment loin d'être
641
parfait, mais sachant que j'ai dû faire
643
ça en de semaines, c'est OK. Et
645
maintenant, voilà le moment que tu
646
attends sûrement depuis le début de la
647
vidéo. OK, c'est parti.
650
Pour l'instant, on tire pas très vite
651
mais les ressentis sont pas mal en vrai.
654
Par contre, j'ai oublié d'enlever le
655
petit cercle blanc.
658
Là, on va s'augmenter, ce qui est très
700
bien. Maintenant, ça devient du très
701
très sérieux.
703
On va se focus sur le prochain booster
704
et pas faire comme dans la comme dans la
706
pub.
709
Et bou !
712
Oh, j'ai oublié les boutages sont
713
incroyables.
715
Euh, OK, let's go. On débloque l'arme.
717
Cette de droite était plus forte, mais
719
je pense que j'aurais pas eu
719
honnêtement. Il est temps de faire comme
722
dans la pub et d'être très stupide. Le P
724
est juste increvable.
726
Bon euh, on booste pour une dernière
728
fois et après on joue
731
ça a l'air trop facile pour l'instant
733
mais j'ai juste copé au niveau de la
734
pub.
740
Tu tiris pas là. Et oui, je me suis fait
743
chier à faire l'avion. What  Par
745
contre, ils sont trop nombreux. J'en
746
avais j'en avais pas mis autant gars.
749
Non, c'est peut-être jouable.
753
Non, là je crois que c'est mort.